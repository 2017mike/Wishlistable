<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="./assets/all.css">
  <title>Document</title>

<style>
 
</style>
</head>

<body>


  <nav>
    <div class="nav-wrapper">
      <a href="/" class="brand-logo">MyWishList</a>
      <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
        <li id="signOutConditional"></li>
      </ul>
    </div>
  </nav>
  
  <ul class="sidenav" id="mobile-demo">
    <li id="signOutNav"></li>
  </ul>


 
<div class="container">
  <h3>
    Hello, welcome to MyWishList!! Make sure to sign in and then click below to make a wishlist. :)
  </h3>

  <a id="addList" class="btn-floating btn-large waves-effect waves-light red"><i class="material-icons">add</i></a>
  
  <div class="row hidden"id="myListRow">
    <form class="col s12">
      <div class="row">
        
        <div class="input-field col s12">
          
          <input placeholder="title" id="listTitle" type="text" class="validate">
          <label for="first_name">Title</label>
        </div>
      </div>
      <button id="createList" class="waves-effect waves-light btn-large">Create List</button>
    </form>
  </div>
  <div class="title">
    <h3>
      My Lists
    </h3>
  </div>
  <div class="collection" id="myLists"></div>  


  

</div>



  <script src="./assets/all.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>

  function makeid(length) {
      var result = '';
      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      var charactersLength = characters.length;
      for (var i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() *
          charactersLength));
      }
      return result;
    }

  document.getElementById("addList").addEventListener('click', event => {
    document.getElementById('myListRow').classList.remove('hidden')
  })

   document.getElementById('createList').addEventListener('click', event => {
      event.preventDefault()
      let randomURL = makeid(10)
      console.log(randomURL)


      // console.log(tabField.value)
      let newList = {
        title: document.getElementById('listTitle').value,
        randomURL: randomURL
      }
      axios.post('/api/lists', newList, {
        headers: {
          'Authorization': `Bearer ${localStorage.getItem('token')}`
        }
      })
        .then(res => {
          console.log(res)
          alert('your list has been created :)')
          window.location = `./makeList/${randomURL}`
        })

    })

    axios.get(`/api/lists/users`, {
        headers: {
          'Authorization': `Bearer ${localStorage.getItem('token')}`
        }
      })
        .then(({ data }) => {
          console.log(data)

          data.forEach(list=>{
          document.getElementById('myLists').innerHTML += `
          
          <h5><a data-link="${list.randomURL}" href="/makeList/${list.randomURL}">${list.title}</a></h5>
          
          
          `
          })
        })
    

    



</script>
</body>

</html>